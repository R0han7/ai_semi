<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Mirror</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #000;
            color: #fff;
            font-family: Arial, sans-serif;
        }
        
        .video-container {
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }
        
        .video-container img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
    </style>
</head>
<body>
    <div class="video-container">
        <img src="{{ url_for('video_feed') }}" alt="Video Feed">
    </div>

    <script>
        // Function to fetch weather information
        async function getWeatherInfo() {
            try {
                const response = await fetch('/get_weather_info');
                const data = await response.json();
                
                if (response.ok) {
                    const weatherDiv = document.getElementById('weatherInfo');
                    weatherDiv.innerHTML = `
                        <h3>Weather Information</h3>
                        <p>Temperature: ${data.temp}Â°C</p>
                        <p>Condition: ${data.condition}</p>
                        <p>Season: ${data.season}</p>
                        <p>Preparation: ${data.additional_prep}</p>
                    `;
                } else {
                    console.error('Weather fetch failed:', data.error);
                }
            } catch (error) {
                console.error('Error fetching weather:', error);
            }
        }

        // Function to get outfit recommendation (now handled through voice commands)
        async function getOutfitRecommendation(event) {
            const formData = new FormData();
            formData.append('event', event);
            
            try {
                const response = await fetch('/get_outfit_recommendation', {
                    method: 'POST',
                    body: formData
                });
                const data = await response.json();
                
                if (response.ok) {
                    const outfitDiv = document.getElementById('outfitRecommendation');
                    const outfitItems = data.outfit_items.map(item => 
                        `${item.type}: ${item.color} ${item.texture} ${item.pattern}`
                    ).join('<br>');
                    
                    outfitDiv.innerHTML = `
                        <h3>Outfit Recommendation</h3>
                        <p>${outfitItems}</p>
                        <p><strong>Why this outfit?</strong><br>${data.explanation}</p>
                        <p><strong>Additional Preparation:</strong><br>${data.additional_prep}</p>
                    `;
                } else {
                    console.error('Outfit recommendation failed:', data.error);
                }
            } catch (error) {
                console.error('Error getting outfit recommendation:', error);
            }
        });

        // Get weather info when page loads and every 5 minutes
        getWeatherInfo();
        setInterval(getWeatherInfo, 5 * 60 * 1000);
    </script>
</body>
</html>